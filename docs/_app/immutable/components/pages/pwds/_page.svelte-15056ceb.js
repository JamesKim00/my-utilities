import{S as rt,i as ot,s as nt,k as E,a as y,q as L,a1 as ht,l as $,m as T,h as p,c as h,r as U,n as P,K as l,b as S,Z as O,L as k,_ as bt,B as q,P as vt,a2 as Et,u as $t,w as Q,x as X,y as tt,f as et,t as st,z as at}from"../../../chunks/index-75a7e759.js";import{g as Pt,s as V,L as St}from"../../../chunks/Link-0934fb9f.js";import{_ as Tt}from"../../../chunks/preload-helper-9b728935.js";let C=null;async function _t(n=""){if(C)return C;const o=await Tt(()=>import("../../../chunks/argon2-a805cf23.js"),["..\\..\\..\\chunks\\argon2-a805cf23.js","..\\..\\..\\chunks\\preload-helper-9b728935.js"],import.meta.url),s=(await Pt()).data.user,a=s==null?void 0:s.email;for(;!n;){const t=prompt("Please enter your master password","Master Password");if(!t||t==="Master Password")continue;const{error:u}=await V.auth.signInWithPassword({password:t,email:a});u||(n=t)}let i=s==null?void 0:s.user_metadata.salt;i||(i=At(10),await V.auth.updateUser({data:{name:s==null?void 0:s.user_metadata.name,salt:i}}));const f=(await o.hash({pass:a+n,salt:i,type:o.ArgonType.Argon2id,hashLen:16,time:2,mem:1024})).hash.buffer;return C=await crypto.subtle.importKey("raw",f,{name:"AES-GCM"},!0,["decrypt","encrypt"]),C}function At(n){let o=new Uint8Array((n||40)/2);return self.crypto.getRandomValues(o),Array.from(o,s=>s.toString(16).padStart(2,"0")).join("")}async function Lt(n){const o=await _t(),s=new TextEncoder().encode(JSON.stringify(n)),a=self.crypto.getRandomValues(new Uint8Array(12)),i=await self.crypto.subtle.encrypt({name:"AES-GCM",iv:a},o,s),f=r=>[...new Uint8Array(r)].map(m=>m.toString(16).padStart(2,"0")).join(""),t=f(i),u=f(a.buffer),{data:b,error:_}=await V.from("passwords").insert([{epds:t,iv:u}]);if(_)throw _;alert("Added password!")}async function Ut(){const n=await _t(),{data:o,error:s}=await V.from("passwords").select("created_at,epds,iv");if(s)throw s;const a=f=>new Uint8Array(f.match(/[\da-f]{2}/gi).map(t=>parseInt(t,16))),i=[];for(let f of o){const t=a(f.epds),u=a(f.iv),b=await self.crypto.subtle.decrypt({name:"AES-GCM",iv:u},n,t),_=new TextDecoder().decode(b);i.push(_)}return i}const{document:wt}=Et;function Bt(n){let o,s,a,i,f,t,u,b,_,r,m,v,I,e,d,H,R,G,j,K,x,D,B,J,M,z,F,N,W,g,Y,Z,it;return{c(){o=E("script"),s=y(),a=E("p"),i=L("Add password:"),f=y(),t=E("form"),u=E("label"),b=L("Email:"),_=y(),r=E("input"),m=y(),v=E("label"),I=L("Password:"),e=y(),d=E("input"),H=y(),R=E("button"),G=L("(show password)?"),j=y(),K=E("label"),x=L("description:"),D=y(),B=E("input"),J=y(),M=E("label"),z=L("Site: (don't need to add https://, can leave empty)"),F=y(),N=E("input"),W=y(),g=E("button"),Y=L("Submit"),this.h()},l(c){const A=ht("svelte-1kwds8g",wt.head);o=$(A,"SCRIPT",{});var yt=T(o);yt.forEach(p),A.forEach(p),s=h(c),a=$(c,"P",{});var lt=T(a);i=U(lt,"Add password:"),lt.forEach(p),f=h(c),t=$(c,"FORM",{});var w=T(t);u=$(w,"LABEL",{for:!0});var pt=T(u);b=U(pt,"Email:"),pt.forEach(p),_=h(w),r=$(w,"INPUT",{id:!0,type:!0,placeholder:!0}),m=h(w),v=$(w,"LABEL",{for:!0});var ut=T(v);I=U(ut,"Password:"),ut.forEach(p),e=h(w),d=$(w,"INPUT",{id:!0,type:!0,placeholder:!0}),H=h(w),R=$(w,"BUTTON",{type:!0});var dt=T(R);G=U(dt,"(show password)?"),dt.forEach(p),j=h(w),K=$(w,"LABEL",{for:!0});var ft=T(K);x=U(ft,"description:"),ft.forEach(p),D=h(w),B=$(w,"INPUT",{type:!0,placeholder:!0}),J=h(w),M=$(w,"LABEL",{for:!0});var ct=T(M);z=U(ct,"Site: (don't need to add https://, can leave empty)"),ct.forEach(p),F=h(w),N=$(w,"INPUT",{type:!0,placeholder:!0}),W=h(w),g=$(w,"BUTTON",{type:!0});var mt=T(g);Y=U(mt,"Submit"),mt.forEach(p),w.forEach(p),this.h()},h(){P(u,"for","email"),P(r,"id","email"),P(r,"type","email"),P(r,"placeholder","Email"),r.required=!0,P(v,"for","password"),P(d,"id","pwd"),P(d,"type","password"),P(d,"placeholder","Password"),d.required=!0,P(R,"type","button"),P(K,"for","description"),P(B,"type","text"),P(B,"placeholder","description"),B.required=!0,P(M,"for","site"),P(N,"type","text"),P(N,"placeholder","google.com"),P(g,"type","submit")},m(c,A){l(wt.head,o),S(c,s,A),S(c,a,A),l(a,i),S(c,f,A),S(c,t,A),l(t,u),l(u,b),l(t,_),l(t,r),O(r,n[0].email),l(t,m),l(t,v),l(v,I),l(t,e),l(t,d),O(d,n[0].password),l(t,H),l(t,R),l(R,G),l(t,j),l(t,K),l(K,x),l(t,D),l(t,B),O(B,n[0].description),l(t,J),l(t,M),l(M,z),l(t,F),l(t,N),O(N,n[0].site),l(t,W),l(t,g),l(g,Y),Z||(it=[k(r,"input",n[2]),k(d,"input",n[3]),k(R,"click",Nt),k(B,"input",n[4]),k(N,"input",n[5]),k(t,"submit",bt(n[1]))],Z=!0)},p(c,[A]){A&1&&r.value!==c[0].email&&O(r,c[0].email),A&1&&d.value!==c[0].password&&O(d,c[0].password),A&1&&B.value!==c[0].description&&O(B,c[0].description),A&1&&N.value!==c[0].site&&O(N,c[0].site)},i:q,o:q,d(c){p(o),c&&p(s),c&&p(a),c&&p(f),c&&p(t),Z=!1,vt(it)}}}function Nt(){const n=document.getElementById("pwd");n.type==="password"?n.type="text":n.type="password"}function It(n,o,s){const a={email:"",password:"",description:"",site:""};async function i(){await Lt(a)}function f(){a.email=this.value,s(0,a)}function t(){a.password=this.value,s(0,a)}function u(){a.description=this.value,s(0,a)}function b(){a.site=this.value,s(0,a)}return[a,i,f,t,u,b]}class Ot extends rt{constructor(o){super(),ot(this,o,It,Bt,nt,{})}}function Rt(n){let o,s,a,i,f,t,u,b,_;return{c(){o=E("h1"),s=L("The passwords!!!!!!!"),a=y(),i=E("button"),f=L("Show the passwords"),t=y(),u=L(n[0])},l(r){o=$(r,"H1",{});var m=T(o);s=U(m,"The passwords!!!!!!!"),m.forEach(p),a=h(r),i=$(r,"BUTTON",{});var v=T(i);f=U(v,"Show the passwords"),v.forEach(p),t=h(r),u=U(r,n[0])},m(r,m){S(r,o,m),l(o,s),S(r,a,m),S(r,i,m),l(i,f),S(r,t,m),S(r,u,m),b||(_=k(i,"click",n[1]),b=!0)},p(r,[m]){m&1&&$t(u,r[0])},i:q,o:q,d(r){r&&p(o),r&&p(a),r&&p(i),r&&p(t),r&&p(u),b=!1,_()}}}function kt(n,o,s){let a="NOT HERE YET";async function i(){s(0,a=JSON.stringify(await Ut()))}return[a,i]}class Ht extends rt{constructor(o){super(),ot(this,o,kt,Rt,nt,{})}}function Kt(n){let o,s,a,i,f,t,u,b,_,r,m,v,I;return s=new St({props:{to:"/"}}),u=new Ot({}),v=new Ht({}),{c(){o=y(),Q(s.$$.fragment),a=y(),i=E("h1"),f=L("Passwords!"),t=y(),Q(u.$$.fragment),b=y(),_=E("h1"),r=L("See passwords:"),m=y(),Q(v.$$.fragment)},l(e){o=h(e),X(s.$$.fragment,e),a=h(e),i=$(e,"H1",{});var d=T(i);f=U(d,"Passwords!"),d.forEach(p),t=h(e),X(u.$$.fragment,e),b=h(e),_=$(e,"H1",{});var H=T(_);r=U(H,"See passwords:"),H.forEach(p),m=h(e),X(v.$$.fragment,e)},m(e,d){S(e,o,d),tt(s,e,d),S(e,a,d),S(e,i,d),l(i,f),S(e,t,d),tt(u,e,d),S(e,b,d),S(e,_,d),l(_,r),S(e,m,d),tt(v,e,d),I=!0},p:q,i(e){I||(et(s.$$.fragment,e),et(u.$$.fragment,e),et(v.$$.fragment,e),I=!0)},o(e){st(s.$$.fragment,e),st(u.$$.fragment,e),st(v.$$.fragment,e),I=!1},d(e){e&&p(o),at(s,e),e&&p(a),e&&p(i),e&&p(t),at(u,e),e&&p(b),e&&p(_),e&&p(m),at(v,e)}}}class Ct extends rt{constructor(o){super(),ot(this,o,null,Kt,nt,{})}}export{Ct as default};
