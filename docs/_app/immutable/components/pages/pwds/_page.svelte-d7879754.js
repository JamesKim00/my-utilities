import{S as J,i as q,s as z,k as g,a as _,q as K,w as P,a0 as ie,l as v,m as b,h as c,c as $,r as M,x as A,n as V,K as h,b as m,y as E,L as fe,Y as ce,f as S,t as x,z as I,a1 as ue,e as U,a2 as Q,a3 as de,B as D,E as ne,u as X}from"../../../chunks/index-0349497c.js";import{s as O,F as j,B as le}from"../../../chunks/Field-7d87549b.js";import{_ as me}from"../../../chunks/preload-helper-9b728935.js";let B=null;async function oe(i=""){if(B)return B;const s=await me(()=>import("../../../chunks/argon2-a805cf23.js"),["..\\..\\..\\chunks\\argon2-a805cf23.js","..\\..\\..\\chunks\\preload-helper-9b728935.js"],import.meta.url),n=(await O.auth.getUser()).data.user,e=n==null?void 0:n.email;for(;!i;){const a=prompt("Please enter your master password","Master Password");if(!a||a==="Master Password")continue;const{error:l}=await O.auth.signInWithPassword({password:a,email:e});l||(i=a)}let t=n==null?void 0:n.user_metadata.salt;t||(t=pe(10),await O.auth.updateUser({data:{name:n==null?void 0:n.user_metadata.name,salt:t}}));const r=(await s.hash({pass:e+i,salt:t,type:s.ArgonType.Argon2id,hashLen:16,time:2,mem:1024})).hash.buffer;return B=await crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!0,["decrypt","encrypt"]),B}function pe(i){let s=new Uint8Array((i||40)/2);return self.crypto.getRandomValues(s),Array.from(s,n=>n.toString(16).padStart(2,"0")).join("")}async function he(i){const s=await oe(),n=new TextEncoder().encode(JSON.stringify(i)),e=self.crypto.getRandomValues(new Uint8Array(12)),t=await self.crypto.subtle.encrypt({name:"AES-GCM",iv:e},s,n),r=u=>[...new Uint8Array(u)].map(p=>p.toString(16).padStart(2,"0")).join(""),a=r(t),l=r(e.buffer),{data:f,error:o}=await O.from("passwords").insert([{epds:a,iv:l}]);if(o)throw o;alert("Added password!")}async function _e(){const i=await oe(),{data:s,error:n}=await O.from("passwords").select("created_at,epds,iv");if(n)throw n;const e=r=>new Uint8Array(r.match(/[\da-f]{2}/gi).map(a=>parseInt(a,16))),t=[];for(let r of s){const a=e(r.epds),l=e(r.iv),f=await self.crypto.subtle.decrypt({name:"AES-GCM",iv:l},i,a),o=new TextDecoder().decode(f);t.push(o)}return t}const{document:Z}=ue;function $e(i){let s,n,e,t,r,a,l,f,o,u,p,L,C,H,N,F,k,R,G,W;return l=new j({props:{is:"email",info:i[1]}}),o=new j({props:{is:"password",info:i[1]}}),p=new j({props:{is:"description",info:i[1]}}),C=new j({props:{is:"site",info:i[1]}}),k=new le({props:{text:"Add Password",isLoading:i[0]}}),{c(){s=g("script"),n=_(),e=g("h1"),t=K("Add a Password:"),r=_(),a=g("form"),P(l.$$.fragment),f=_(),P(o.$$.fragment),u=_(),P(p.$$.fragment),L=_(),P(C.$$.fragment),H=_(),N=g("div"),F=_(),P(k.$$.fragment),this.h()},l(d){const y=ie("svelte-1kwds8g",Z.head);s=v(y,"SCRIPT",{});var T=b(s);T.forEach(c),y.forEach(c),n=$(d),e=v(d,"H1",{class:!0});var Y=b(e);t=M(Y,"Add a Password:"),Y.forEach(c),r=$(d),a=v(d,"FORM",{});var w=b(a);A(l.$$.fragment,w),f=$(w),A(o.$$.fragment,w),u=$(w),A(p.$$.fragment,w),L=$(w),A(C.$$.fragment,w),H=$(w),N=v(w,"DIV",{class:!0}),b(N).forEach(c),F=$(w),A(k.$$.fragment,w),w.forEach(c),this.h()},h(){V(e,"class","text-2xl"),V(N,"class","h-3")},m(d,y){h(Z.head,s),m(d,n,y),m(d,e,y),h(e,t),m(d,r,y),m(d,a,y),E(l,a,null),h(a,f),E(o,a,null),h(a,u),E(p,a,null),h(a,L),E(C,a,null),h(a,H),h(a,N),h(a,F),E(k,a,null),R=!0,G||(W=fe(a,"submit",ce(i[2])),G=!0)},p(d,[y]){const T={};y&1&&(T.isLoading=d[0]),k.$set(T)},i(d){R||(S(l.$$.fragment,d),S(o.$$.fragment,d),S(p.$$.fragment,d),S(C.$$.fragment,d),S(k.$$.fragment,d),R=!0)},o(d){x(l.$$.fragment,d),x(o.$$.fragment,d),x(p.$$.fragment,d),x(C.$$.fragment,d),x(k.$$.fragment,d),R=!1},d(d){c(s),d&&c(n),d&&c(e),d&&c(r),d&&c(a),I(l),I(o),I(p),I(C),I(k),G=!1,W()}}}function we(i,s,n){const e={email:"",password:"",description:"",site:""};let t=!1;return[t,e,async()=>{n(0,t=!0),await he(e),n(0,t=!1)}]}class ge extends J{constructor(s){super(),q(this,s,we,$e,z,{})}}function ee(i,s,n){const e=i.slice();return e[4]=s[n],e}function te(i,s,n){const e=i.slice();return e[7]=s[n][0],e[8]=s[n][1],e}function se(i){let s,n,e={ctx:i,current:null,token:null,hasCatch:!1,pending:ye,then:be,catch:ve,value:3};return Q(n=i[0],e),{c(){s=U(),e.block.c()},l(t){s=U(),e.block.l(t)},m(t,r){m(t,s,r),e.block.m(t,e.anchor=r),e.mount=()=>s.parentNode,e.anchor=s},p(t,r){i=t,e.ctx=i,r&1&&n!==(n=i[0])&&Q(n,e)||de(e,i,r)},d(t){t&&c(s),e.block.d(t),e.token=null,e=null}}}function ve(i){return{c:D,l:D,m:D,p:D,d:D}}function be(i){let s,n=i[3],e=[];for(let t=0;t<n.length;t+=1)e[t]=re(ee(i,n,t));return{c(){for(let t=0;t<e.length;t+=1)e[t].c();s=U()},l(t){for(let r=0;r<e.length;r+=1)e[r].l(t);s=U()},m(t,r){for(let a=0;a<e.length;a+=1)e[a].m(t,r);m(t,s,r)},p(t,r){if(r&1){n=t[3];let a;for(a=0;a<n.length;a+=1){const l=ee(t,n,a);e[a]?e[a].p(l,r):(e[a]=re(l),e[a].c(),e[a].m(s.parentNode,s))}for(;a<e.length;a+=1)e[a].d(1);e.length=n.length}},d(t){ne(e,t),t&&c(s)}}}function ae(i){let s,n,e=i[7].charAt(0).toUpperCase()+i[7].slice(1)+": ",t,r,a,l=i[8]+"",f;return{c(){s=g("div"),n=g("div"),t=K(e),r=_(),a=g("div"),f=K(l),this.h()},l(o){s=v(o,"DIV",{class:!0});var u=b(s);n=v(u,"DIV",{class:!0});var p=b(n);t=M(p,e),p.forEach(c),r=$(u),a=v(u,"DIV",{class:!0});var L=b(a);f=M(L,l),L.forEach(c),u.forEach(c),this.h()},h(){V(n,"class","w-[8rem]"),V(a,"class",""),V(s,"class","flex flex-row")},m(o,u){m(o,s,u),h(s,n),h(n,t),h(s,r),h(s,a),h(a,f)},p(o,u){u&1&&e!==(e=o[7].charAt(0).toUpperCase()+o[7].slice(1)+": ")&&X(t,e),u&1&&l!==(l=o[8]+"")&&X(f,l)},d(o){o&&c(s)}}}function re(i){let s,n,e=Object.entries(JSON.parse(i[4])),t=[];for(let r=0;r<e.length;r+=1)t[r]=ae(te(i,e,r));return{c(){for(let r=0;r<t.length;r+=1)t[r].c();s=_(),n=g("div"),this.h()},l(r){for(let a=0;a<t.length;a+=1)t[a].l(r);s=$(r),n=v(r,"DIV",{class:!0}),b(n).forEach(c),this.h()},h(){V(n,"class","h-4")},m(r,a){for(let l=0;l<t.length;l+=1)t[l].m(r,a);m(r,s,a),m(r,n,a)},p(r,a){if(a&1){e=Object.entries(JSON.parse(r[4]));let l;for(l=0;l<e.length;l+=1){const f=te(r,e,l);t[l]?t[l].p(f,a):(t[l]=ae(f),t[l].c(),t[l].m(s.parentNode,s))}for(;l<t.length;l+=1)t[l].d(1);t.length=e.length}},d(r){ne(t,r),r&&c(s),r&&c(n)}}}function ye(i){let s;return{c(){s=K("Loading...")},l(n){s=M(n,"Loading...")},m(n,e){m(n,s,e)},p:D,d(n){n&&c(s)}}}function ke(i){let s,n,e,t,r,a,l;t=new le({props:{text:"load",click:i[2]}});let f=i[0]&&se(i);return{c(){s=g("h1"),n=K("See the Passwords:"),e=_(),P(t.$$.fragment),r=_(),f&&f.c(),a=U(),this.h()},l(o){s=v(o,"H1",{class:!0});var u=b(s);n=M(u,"See the Passwords:"),u.forEach(c),e=$(o),A(t.$$.fragment,o),r=$(o),f&&f.l(o),a=U(),this.h()},h(){V(s,"class","text-2xl")},m(o,u){m(o,s,u),h(s,n),m(o,e,u),E(t,o,u),m(o,r,u),f&&f.m(o,u),m(o,a,u),l=!0},p(o,[u]){const p={};u&1&&(p.click=o[2]),t.$set(p),o[0]?f?f.p(o,u):(f=se(o),f.c(),f.m(a.parentNode,a)):f&&(f.d(1),f=null)},i(o){l||(S(t.$$.fragment,o),l=!0)},o(o){x(t.$$.fragment,o),l=!1},d(o){o&&c(s),o&&c(e),I(t,o),o&&c(r),f&&f.d(o),o&&c(a)}}}function Pe(i,s,n){const e=async()=>await _e();let t;return[t,e,()=>n(0,t=e())]}class Ae extends J{constructor(s){super(),q(this,s,Pe,ke,z,{})}}function Ee(i){let s,n,e,t,r,a;return s=new ge({}),r=new Ae({}),{c(){P(s.$$.fragment),n=_(),e=g("div"),t=_(),P(r.$$.fragment),this.h()},l(l){A(s.$$.fragment,l),n=$(l),e=v(l,"DIV",{class:!0}),b(e).forEach(c),t=$(l),A(r.$$.fragment,l),this.h()},h(){V(e,"class","h-6")},m(l,f){E(s,l,f),m(l,n,f),m(l,e,f),m(l,t,f),E(r,l,f),a=!0},p:D,i(l){a||(S(s.$$.fragment,l),S(r.$$.fragment,l),a=!0)},o(l){x(s.$$.fragment,l),x(r.$$.fragment,l),a=!1},d(l){I(s,l),l&&c(n),l&&c(e),l&&c(t),I(r,l)}}}class Ve extends J{constructor(s){super(),q(this,s,null,Ee,z,{})}}export{Ve as default};
