import{S as rt,i as ot,s as nt,k as E,a as y,q as U,Z as ht,l as $,m as T,h as p,c as h,r as L,n as P,M as l,b as S,U as O,O as R,V as bt,B as q,X as vt,_ as Et,u as $t,w as Z,x as Q,y as tt,f as et,t as st,z as at}from"../../../chunks/index-53c0c08a.js";import{g as Pt,s as K,L as St}from"../../../chunks/Link-7b05a820.js";import{_ as Tt}from"../../../chunks/preload-helper-9b728935.js";let C=null;async function _t(n=""){if(C)return C;const o=await Tt(()=>import("../../../chunks/argon2-a805cf23.js"),["..\\..\\..\\chunks\\argon2-a805cf23.js","..\\..\\..\\chunks\\preload-helper-9b728935.js"],import.meta.url),s=(await Pt()).data.user,a=s==null?void 0:s.email;for(;!n;){const t=prompt("Please enter your master password","Master Password");if(!t||t==="Master Password")continue;const{error:u}=await K.auth.signInWithPassword({password:t,email:a});u||(n=t)}let i=s==null?void 0:s.user_metadata.salt;i||(i=At(10),await K.auth.updateUser({data:{name:s==null?void 0:s.user_metadata.name,salt:i}}));const f=(await o.hash({pass:a+n,salt:i,type:o.ArgonType.Argon2id,hashLen:16,time:2,mem:1024})).hash.buffer;return C=await crypto.subtle.importKey("raw",f,{name:"AES-GCM"},!0,["decrypt","encrypt"]),C}function At(n){let o=new Uint8Array((n||40)/2);return self.crypto.getRandomValues(o),Array.from(o,s=>s.toString(16).padStart(2,"0")).join("")}async function Ut(n){const o=await _t(),s=new TextEncoder().encode(JSON.stringify(n)),a=self.crypto.getRandomValues(new Uint8Array(12)),i=await self.crypto.subtle.encrypt({name:"AES-GCM",iv:a},o,s),f=r=>[...new Uint8Array(r)].map(m=>m.toString(16).padStart(2,"0")).join(""),t=f(i),u=f(a.buffer),{data:b,error:_}=await K.from("passwords").insert([{epds:t,iv:u}]);if(_)throw _;alert("Added password!")}async function Lt(){const n=await _t(),{data:o,error:s}=await K.from("passwords").select("created_at,epds,iv");if(s)throw s;const a=f=>new Uint8Array(f.match(/[\da-f]{2}/gi).map(t=>parseInt(t,16))),i=[];for(let f of o){const t=a(f.epds),u=a(f.iv),b=await self.crypto.subtle.decrypt({name:"AES-GCM",iv:u},n,t),_=new TextDecoder().decode(b);i.push(_)}return i}const{document:wt}=Et;function Bt(n){let o,s,a,i,f,t,u,b,_,r,m,v,I,e,d,k,M,G,j,H,x,D,B,J,V,z,F,N,W,g,X,Y,it;return{c(){o=E("script"),s=y(),a=E("p"),i=U("Add password:"),f=y(),t=E("form"),u=E("label"),b=U("Email:"),_=y(),r=E("input"),m=y(),v=E("label"),I=U("Password:"),e=y(),d=E("input"),k=y(),M=E("button"),G=U("(show password)?"),j=y(),H=E("label"),x=U("description:"),D=y(),B=E("input"),J=y(),V=E("label"),z=U("Site: (don't need to add https://, can leave empty)"),F=y(),N=E("input"),W=y(),g=E("button"),X=U("Submit"),this.h()},l(c){const A=ht("svelte-1kwds8g",wt.head);o=$(A,"SCRIPT",{});var yt=T(o);yt.forEach(p),A.forEach(p),s=h(c),a=$(c,"P",{});var lt=T(a);i=L(lt,"Add password:"),lt.forEach(p),f=h(c),t=$(c,"FORM",{});var w=T(t);u=$(w,"LABEL",{for:!0});var pt=T(u);b=L(pt,"Email:"),pt.forEach(p),_=h(w),r=$(w,"INPUT",{id:!0,type:!0,placeholder:!0}),m=h(w),v=$(w,"LABEL",{for:!0});var ut=T(v);I=L(ut,"Password:"),ut.forEach(p),e=h(w),d=$(w,"INPUT",{id:!0,type:!0,placeholder:!0}),k=h(w),M=$(w,"BUTTON",{type:!0});var dt=T(M);G=L(dt,"(show password)?"),dt.forEach(p),j=h(w),H=$(w,"LABEL",{for:!0});var ft=T(H);x=L(ft,"description:"),ft.forEach(p),D=h(w),B=$(w,"INPUT",{type:!0,placeholder:!0}),J=h(w),V=$(w,"LABEL",{for:!0});var ct=T(V);z=L(ct,"Site: (don't need to add https://, can leave empty)"),ct.forEach(p),F=h(w),N=$(w,"INPUT",{type:!0,placeholder:!0}),W=h(w),g=$(w,"BUTTON",{type:!0});var mt=T(g);X=L(mt,"Submit"),mt.forEach(p),w.forEach(p),this.h()},h(){P(u,"for","email"),P(r,"id","email"),P(r,"type","email"),P(r,"placeholder","Email"),r.required=!0,P(v,"for","password"),P(d,"id","pwd"),P(d,"type","password"),P(d,"placeholder","Password"),d.required=!0,P(M,"type","button"),P(H,"for","description"),P(B,"type","text"),P(B,"placeholder","description"),B.required=!0,P(V,"for","site"),P(N,"type","text"),P(N,"placeholder","google.com"),P(g,"type","submit")},m(c,A){l(wt.head,o),S(c,s,A),S(c,a,A),l(a,i),S(c,f,A),S(c,t,A),l(t,u),l(u,b),l(t,_),l(t,r),O(r,n[0].email),l(t,m),l(t,v),l(v,I),l(t,e),l(t,d),O(d,n[0].password),l(t,k),l(t,M),l(M,G),l(t,j),l(t,H),l(H,x),l(t,D),l(t,B),O(B,n[0].description),l(t,J),l(t,V),l(V,z),l(t,F),l(t,N),O(N,n[0].site),l(t,W),l(t,g),l(g,X),Y||(it=[R(r,"input",n[2]),R(d,"input",n[3]),R(M,"click",Nt),R(B,"input",n[4]),R(N,"input",n[5]),R(t,"submit",bt(n[1]))],Y=!0)},p(c,[A]){A&1&&r.value!==c[0].email&&O(r,c[0].email),A&1&&d.value!==c[0].password&&O(d,c[0].password),A&1&&B.value!==c[0].description&&O(B,c[0].description),A&1&&N.value!==c[0].site&&O(N,c[0].site)},i:q,o:q,d(c){p(o),c&&p(s),c&&p(a),c&&p(f),c&&p(t),Y=!1,vt(it)}}}function Nt(){const n=document.getElementById("pwd");n.type==="password"?n.type="text":n.type="password"}function It(n,o,s){const a={email:"",password:"",description:"",site:""};async function i(){await Ut(a)}function f(){a.email=this.value,s(0,a)}function t(){a.password=this.value,s(0,a)}function u(){a.description=this.value,s(0,a)}function b(){a.site=this.value,s(0,a)}return[a,i,f,t,u,b]}class Ot extends rt{constructor(o){super(),ot(this,o,It,Bt,nt,{})}}function Mt(n){let o,s,a,i,f,t,u,b,_;return{c(){o=E("h1"),s=U("The passwords!!!!!!!"),a=y(),i=E("button"),f=U("Show the passwords"),t=y(),u=U(n[0])},l(r){o=$(r,"H1",{});var m=T(o);s=L(m,"The passwords!!!!!!!"),m.forEach(p),a=h(r),i=$(r,"BUTTON",{});var v=T(i);f=L(v,"Show the passwords"),v.forEach(p),t=h(r),u=L(r,n[0])},m(r,m){S(r,o,m),l(o,s),S(r,a,m),S(r,i,m),l(i,f),S(r,t,m),S(r,u,m),b||(_=R(i,"click",n[1]),b=!0)},p(r,[m]){m&1&&$t(u,r[0])},i:q,o:q,d(r){r&&p(o),r&&p(a),r&&p(i),r&&p(t),r&&p(u),b=!1,_()}}}function Rt(n,o,s){let a="NOT HERE YET";async function i(){s(0,a=JSON.stringify(await Lt()))}return[a,i]}class kt extends rt{constructor(o){super(),ot(this,o,Rt,Mt,nt,{})}}function Ht(n){let o,s,a,i,f,t,u,b,_,r,m,v,I;return s=new St({props:{to:"/"}}),u=new Ot({}),v=new kt({}),{c(){o=y(),Z(s.$$.fragment),a=y(),i=E("h1"),f=U("Passwords!"),t=y(),Z(u.$$.fragment),b=y(),_=E("h1"),r=U("See passwords:"),m=y(),Z(v.$$.fragment)},l(e){o=h(e),Q(s.$$.fragment,e),a=h(e),i=$(e,"H1",{});var d=T(i);f=L(d,"Passwords!"),d.forEach(p),t=h(e),Q(u.$$.fragment,e),b=h(e),_=$(e,"H1",{});var k=T(_);r=L(k,"See passwords:"),k.forEach(p),m=h(e),Q(v.$$.fragment,e)},m(e,d){S(e,o,d),tt(s,e,d),S(e,a,d),S(e,i,d),l(i,f),S(e,t,d),tt(u,e,d),S(e,b,d),S(e,_,d),l(_,r),S(e,m,d),tt(v,e,d),I=!0},p:q,i(e){I||(et(s.$$.fragment,e),et(u.$$.fragment,e),et(v.$$.fragment,e),I=!0)},o(e){st(s.$$.fragment,e),st(u.$$.fragment,e),st(v.$$.fragment,e),I=!1},d(e){e&&p(o),at(s,e),e&&p(a),e&&p(i),e&&p(t),at(u,e),e&&p(b),e&&p(_),e&&p(m),at(v,e)}}}class Ct extends rt{constructor(o){super(),ot(this,o,null,Ht,nt,{})}}export{Ct as default};
